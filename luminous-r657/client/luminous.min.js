var luminous_version="0.5.7";var luminous_date="04/02/11";var luminous_initialised=false,luminous_fixed_bar=false,metabar_buttons='<span class="metabar_buttons"><a href=# class="link luminous_uncollapse_clicker" title="Expand">&nbsp;</a><a href=# class="link luminous_search_clicker" title="Search">&nbsp;</a><a href=# class="link zoomout luminous_zoomout_clicker" title="Font size--">&nbsp;</a><a href=# class="link zoomin luminous_zoomin_clicker" title="Font size++">&nbsp;</a><a href=# class="link unhighlight luminous_plain_clicker" title="Toggle Highlighting">&nbsp;</a><a href=# class="link print luminous_print_clicker" title="Print">&nbsp;</a><a href=# class="link info luminous_info_clicker" title="Highlighting info">&nbsp;</a></span>';function luminous_exp_collapse(b){var d=jQuery("div.code_container",b),c,a;jQuery(".luminous_uncollapse_clicker",b).toggleClass("luminous_collapse_clicker");if(b.data("collapsed")){c=jQuery(window).scrollTop();c-=d.offset().top;d.css("max-height",b.data("max-height")).css("overflow","auto");b.data("collapsed",false);jQuery(".luminous_uncollapse_clicker",b).attr("title","Expand");window.scrollTo(window.scrollLeft,d.offset().top);d.scrollTop(c)}else{a=d[0].scrollTop;a+=d.offset().top;d[0].scrollTop=0;b.data("max-height",d.css("max-height")).data("collapsed",true);d.css("max-height","none").css("overflow","visible");jQuery(".luminous_uncollapse_clicker",b).attr("title","Collapse");window.scrollTo(window.scrollLeft,a)}}function luminous_search_open(a){jQuery(a).data("search_index",0);var b=jQuery('<input type="text" class="luminous_search"></input>'),d=jQuery('<div class="luminous_search_container"><a href=# class="link luminous_close_search_clicker luminous_clicker">&nbsp</a></div>'),c;jQuery(".luminous_close_search_clicker",d).click(function(){luminous_close_search(luminous_root(this));return false});b.keypress(function(f){if(f.keyCode==13){luminous_search_submit(luminous_root(jQuery(this)),this.value)}else{if(f.keyCode==27){luminous_close_search(luminous_root(jQuery(this)))}}return true});c=luminous_get_tr_position(a);c.left-=15;c.top+=35;d.prepend(b);b.css("width","98px");a.prepend(d);d.css("left",(c.left-d.width())+"px").css("top",c.top+"px");b.focus()}function _luminous_search(){var a=jQuery(".luminous_active_search");if(!a.length){return}var m=luminous_root(a),n=a.data("search_data"),e=n.i;while(n.i<n.html.length&&n.i-e<1024*10){var p=n.html.charAt(n.i),h=n.html.substr(n.i),d;if(p=="<"){d=h.search(">")+1;if(!n.matching){n.html_new+=h.substr(0,d)}n.i+=d;continue}else{if(p=="&"){d=h.search(";")+1;if(!n.matching){n.html_new+=h.substr(0,d)}n.i+=d;continue}}if(!n.matching&&n.searchstr.charAt(0)!=p){var j=h.indexOf(n.searchstr.charAt(0));if(j==-1){n.html_new+=h;n.i=n.html.length;break}var l=h.substr(j),g=l.indexOf(">"),f=l.indexOf("<"),t=j;if((g!=-1&&f==-1)||(g!=-1&&f!=-1&&g<f)){t=j+g}var b=n.i+t,k=Math.max(0,b-5),q=n.html.substr(k,b-k);if(q.search(/&[^;]*$/)!=-1){t=j+l.search(";")}n.i+=t;n.html_new+=h.substr(0,t);continue}match_len=n.sub_match.length;var s=false;if(!n.matching){if(p==n.searchstr.charAt(0)){n.open=n.i;n.sub_match=p;n.matching=true}}else{if(n.matching){if(p==n.searchstr.charAt(match_len)){n.sub_match+=p;n.matching=true}else{s=true;n.matching=false}}}if(n.matching){if(n.sub_match.length==n.searchstr.length){var r,o;r=n.html.substr(n.open,n.i+1-n.open);r=r.replace(/(<span.*?>)/gi,"</hl>$1<hl>");r=r.replace(/(<\/span.*?>)/gi,"</hl>$1<hl>");r=r.replace(/<hl>/g,"<span class='user_highlight'>");r=r.replace(/<\/hl>/g,"</span>");o="<span class='user_highlight'>"+r+"</span>";n.html_new+=o;n.sub_match="";n.matching=false}}else{if(s){var r=n.html.substr(n.open,n.i-n.open);n.html_new+=r;n.html_new+=p;n.sub_match="";n.matching=false}else{n.html_new+=p}}n.i++}if(n.i>=n.html.length){var i=(n.plain)?"plain":"highlighted";$new=jQuery('<pre class="code '+i+'">'+n.html_new+"</pre>");jQuery("pre."+i,m).replaceWith($new);jQuery("div.searching",m).remove();a.toggleClass("luminous_active_search")}else{jQuery("span.search_progress",m).html(Math.round(n.i/n.html.length*100)+"%");jQuery(".luminous_search_container",m).data("search_data",n);setTimeout(function(){_luminous_search()},100)}}function luminous_search_submit(a,c){luminous_search_reset(a);c=c.replace(/&/g,"&amp;");c=c.replace(/</g,"&lt;");c=c.replace(/>/g,"&gt;");var b=a.data("code_view")=="plain";if(!c.length){return}var d={i:0,plain:b,html:(b)?jQuery("pre.plain",a).html():jQuery("pre.highlighted",a).html(),html_new:"",sub_match:"",open:0,matching:false,searchstr:c};jQuery(".luminous_search_container",a).toggleClass("luminous_active_search").append(jQuery('<div class="searching"><span class="search_progress"></span> <a href="#" class="luminous_search_cancel">Cancel</a></div>'));jQuery(".luminous_search_container",a).data("search_data",d);jQuery(".luminous_search_cancel",a).click(function(){var e=luminous_root(this);jQuery(".luminous_active_search",e).toggleClass("luminous_active_search");jQuery("div.searching",e).remove();luminous_close_search(e);return false});_luminous_search()}function luminous_search_reset(a){jQuery(".luminous_active_search").toggleClass("luminous_active_search");jQuery(".user_highlight",a).each(function(b,c){jQuery(c).replaceWith(jQuery(c).html())})}function luminous_close_search(a){luminous_search_reset(a);jQuery(".luminous_search_container",a).fadeOut(250,function(){jQuery(this).remove()})}function luminous_show_info(b){var a=jQuery(".luminous_info",jQuery(b));if(!a.length){luminous_attach_infopane(b)}jQuery(".luminous_info",jQuery(b)).fadeIn(500);return false}function luminous_close_info(a){if(jQuery.browser.msie){jQuery(".luminous_info",jQuery(a)).hide()}else{jQuery(".luminous_info",jQuery(a)).fadeOut(500)}luminous_show_buttons(a);return false}function luminous_get_tr_position(c){var e=c.offset(),b=jQuery(c).parents(),d,a=jQuery(window).scrollTop(),g,f;for(d=0;d<b.length;d++){f=jQuery(b[d]);if(f.is("body")){break}e.top+=f.scrollTop()}e.top-=a;g=e;g.left=e.left+=c.width();g.left-=jQuery(window).scrollLeft();g.top=Math.max(g.top,0);return g}function luminous_show_buttons(a){if(luminous_fixed_bar){return}if(jQuery.browser.msie&&jQuery.browser.version<=7){jQuery(".metabar_buttons",a).css("position","absolute").css("right","5px")}else{var b=jQuery(".metabar_buttons",a).width();var c=luminous_get_tr_position(a);c.top+=10;c.left-=b+20;jQuery(".metabar_buttons",a).css("top",c.top+"px").css("left",c.left+"px")}jQuery(".metabar_buttons",a).show()}function luminous_hide_buttons(a){if(luminous_fixed_bar){return}jQuery(".metabar_buttons",a).fadeOut(100)}function luminous_toggle_plain(b){var e=jQuery("pre.highlighted",b).filter(function(f){return !jQuery(this).hasClass("plain")});if(!jQuery("pre.plain",b).length){var d=e.html();var c=d.replace(/<.*?>/ig,"");jQuery("pre.code",b).parent().prepend(jQuery('<pre class="code plain">'+c+"</pre>").hide())}c=jQuery("pre.plain",b);jQuery(".luminous_plain_clicker",b).toggleClass("highlight unhighlight");if(1||jQuery.browser.msie){if(jQuery(e).css("display")=="none"){b.data("code_view","highlighted")}else{b.data("code_view","plain")}e.add(c).toggle();return}var a=function(){jQuery(this).css("position","relative")};c.css("position","absolute");e.css("position","absolute");if(jQuery(e).css("display")=="none"){e.fadeIn(500,a);c.fadeOut(500);b.data("code_view","highlighted")}else{e.fadeOut(500);c.fadeIn(500,a);b.data("code_view","plain")}}function luminous_root(a){while(a!=[]&&!jQuery(a).hasClass("luminous")){a=jQuery(a).parent()}return a}function luminous_print_arrange_numbered(e){var h=jQuery("span.line_number",jQuery(e)),b="",f,l=jQuery("span.line",jQuery(e)),m,a,c,k="";for(f=0;f<h.length;f++){b+=jQuery(h[f]).html().replace(/<.*?>/g,"")+"\n"}for(var f=0;f<l.length;f++){k+=jQuery(l[f]).html()+"\n"}m="<ol>";lines=k.split("\n");a=b.split("\n");c=lines.length;for(f=0;f<c;f++){m+="<li style='white-space:pre-wrap;'>"+lines[f];var d=f+1,g;while(d<c&&(g=a[d].match(/\d+/))==null){m+=lines[d++];f++}m+="</li>"}m+="</ol>";return m}function luminous_print_arrange_non_numbered(a){return jQuery("pre.code",jQuery(a)).html()}function luminous_print(b){var d='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head>'+(jQuery("title")?("<title>"+jQuery("title").html()+"</title>"):"")+"",g=jQuery("link"),e="",c,a,j,h,f;for(c=0;c<g.length;c++){a=g[c].href;if(a.match(/\/luminous(?:\.min)?\.css$/i)){e=a.replace(/\/luminous.css$/,"/luminous_light.css")}else{continue}d+="<link rel='stylesheet' type='text/css' href='"+g[c].href+"'>\n"}d+="<link rel='stylesheet' type='text/css' href='"+e+"'><link rel='stylesheet' type='text/css' href='"+e.replace(/_light.css$/,"_print.css")+"'><style type='text/css'>div.luminous { font-size: "+jQuery(b).css("font-size")+" !important;}</style></head>\n<body onload='window.print();'><div class='luminous'>";j=jQuery("td.line_number_bar",jQuery(b)).length?luminous_print_arrange_numbered(b):luminous_print_arrange_non_numbered(b);h=jQuery(b).clone();$cc_contents=jQuery("<pre class=code>"+j+"</pre>");jQuery("div.code_container",h).html($cc_contents);jQuery("div.code_container",h).css("max-height","none");d+=h.html();d+="</div></body>\n</html>\n";f=window.open();f.top.document.open();f.top.document.write(d);f.document.close()}function luminous_get_info_element(b){var a;if(b===true){a=jQuery("<span class='code luminous_info'>    Highlighting peformed by Luminous.    <a class=link href='http://www.asgaard.co.uk/p/Luminous'     target=_blank>More info</a> | <a href=# class='luminous_info_close link'>    Close</a></span>")}else{a=jQuery("<span class='luminous_info code' style='padding-top:1em'>    <h1 style='text-align:center; margin-top:0;' class='keyword'>    Luminous "+luminous_version+" "+luminous_date+" </h1>  <p>This source was highlighted with <span class='keyword'>Luminous</span>. Visit   <a class=link href='http://code.google.com/p/luminous/' target=_blank>  http://code.google.com/p/luminous/</a> for the latest   stable and development versions, and   <a class=link   href=http://www.asgaard.co.uk/p/Luminous   target=_blank>  http://www.asgaard.co.uk/p/Luminous</a>  for more information</p>    <p><span class='keyword'>Luminous</span> is free software (GPL)</p>    <p><span class='comment'>&copy; 2010 Mark Watkinson    <em>&lt;markwatkinson@gmail.com&gt;</em></span></p>    <p><a href=# class='luminous_info_close link'    >Close</a></p>    </span>")}jQuery(".luminous_info_close",a).click(function(c){luminous_close_info((luminous_root((c.target))));return false});return a}function luminous_attach_infopane(a){jQuery(a).prepend(luminous_get_info_element(jQuery(a).height()<100))}function luminous_determine_id(a){while(a&&!jQuery(a).hasClass("luminous")){a=a.parentNode}if(!a){return -1}return parseInt(a.id.match(/\d+$/))}function luminous_bind(c){var p=jQuery(c),l,k;if(p.data("luminous")==true){return}p.data("luminous",true);jQuery("pre.code",p).addClass("highlighted");l=jQuery(metabar_buttons);jQuery(l).bind("mousedown",function(h){return false});k=!(jQuery.browser.msie&&jQuery.browser.version<=7);if(k){jQuery(l).hide();jQuery(l).addClass("metabar_buttons_floating");jQuery("div.luminous").bind("mouseenter",function(h){luminous_show_buttons(luminous_root(h.target))});jQuery("div.luminous").bind("mouseleave",function(h){luminous_hide_buttons(luminous_root(h.target))})}else{l.addClass("metabar_buttons_fixed");l=jQuery('<div class="metabar"></div>').append(l)}p.prepend(l);if(!k){var j=jQuery("pre.highlighted",p).html().replace(/<.*?>/g,"").length,d=jQuery("pre.line_numbers",p).children(),o=null,g,n,b,e,s;if(d.length){for(e=d.length-1;e>=0;e--){o=parseInt(jQuery(d[e]).html().replace(/&.*?;|\s/g,""));if(!isNaN(o)){break}}}if(isNaN(o)||o==null){o=jQuery("pre.highlighted",p).html().match(/\n/g).length}j/=1024;j=""+j.toFixed(2);g=p.find(".metabar").html();p.find(".metabar").prepend(jQuery("<span>Source code | "+o+" lines | "+j+" KiB</span>").css("margin-left","2px").css("margin-top","2px").css("display","inline-block"));n=p.parents();b=jQuery(n[0]).width();for(e=1;e<n.length;e++){b=Math.min(b,jQuery(n[e]).width())}s=p.width()-b;if(s>0){p.find(".metabar_buttons").css("right",s+"px")}}var a=jQuery("div.code_container",p).get(0);if(typeof a=="undefined"){return}var f=a.scrollHeight,g=a.clientHeight,r=a.scrollWidth,q=a.clientWidth;if(f<=g&&r<=q){jQuery(".luminous_uncollapse_clicker",p).hide()}jQuery(".luminous_uncollapse_clicker",p).click(function(h){luminous_exp_collapse(luminous_root((h.target)));return false});jQuery(".luminous_search_clicker",p).click(function(h){luminous_search_open(luminous_root((h.target)));return false});jQuery(".luminous_info_clicker",p).click(function(h){luminous_show_info(luminous_root((h.target)));luminous_hide_buttons(luminous_root((h.target)));return false});jQuery(".luminous_print_clicker",p).click(function(h){luminous_print(luminous_root((h.target)));luminous_hide_buttons(luminous_root((h.target)));return false});jQuery(".luminous_plain_clicker",p).click(function(h){luminous_toggle_plain(luminous_root((h.target)));return false});var m=function(h){p.fadeTo(200,0,function(){var u=jQuery(this).css("font-size"),t=u.replace(/^(\d+(\.\d+)?).*/,"$1"),i=u.replace(/^(\d+(\.\d+)?)/,"");t=(h)?++t:--t;if(t>1){jQuery(this).css("font-size",t+i)}jQuery(this).fadeTo(200,1)})};jQuery(".luminous_zoomin_clicker",p).click(function(h){m(true);return false});jQuery(".luminous_zoomout_clicker",p).click(function(h){m(false);return false});jQuery("a.line_number",p).each(function(t,u){var h=jQuery(u);h.click(function(x){var v=jQuery(this),i=v.attr("id").replace(/^lineno/,"line"),w="#"+i;jQuery(w).toggleClass("highlighted_line");return false})});luminous_opera_hack(p)}function luminous_opera_hack(b){if(!jQuery.browser.opera){return}var f=jQuery(b),e=true,a=document.doctype,h;if(a!=undefined){var g=captureDoctypeType=a.publicId,c=captureDoctypePath=a.systemId;if(c.match(/strict\.dtd/)){e=false}else{if(g.replace(/(^[\s]+)|([\s]+$)/g).toLowerCase()=="html"){e=false}}}if(!e){return}h=jQuery(document).html();jQuery("span.line",f).each(function(j,k){var d=jQuery(k).html();if(d.replace(/<.*?>/g,"").replace(/(^[\s]+)|([\s]+$)/g,"")==""){jQuery(k).html("&nbsp;"+d)}})}function luminous_init(){jQuery("div.luminous").each(function(){luminous_bind(this)})}jQuery(document).ready(function(){luminous_init()});